<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zarotec - متجر تروتينات إلكترونية عصري</title>
    <meta name="description" content="Zarotec - متجر تروتينات إلكترونية عصرية بجودة عالية وأسعار منافسة">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&family=Almarai:wght@300;400;700;800&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for Light and Dark Modes */
        :root {
            --primary: #FF6B35;
            --primary-light: #FF8A65;
            --primary-dark: #E55A2B;
            --secondary: #2C3E50;
            --accent: #3498DB;
            --text: #333333;
            --text-light: #666666;
            --bg: #ffffff;
            --bg-secondary: #f8f8f8;
            --card-bg: #ffffff;
            --border: #e0e0e0;
            --shadow: rgba(0, 0, 0, 0.08);
            --shadow-hover: rgba(0, 0, 0, 0.15);
            --footer-bg: #2c2c2c;
            --footer-text: #f0f0f0;
            --success: #27AE60;
            --warning: #F39C12;
            --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --transition-slow: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .dark-mode {
            --primary: #FF6B35;
            --primary-light: #FF8A65;
            --primary-dark: #E55A2B;
            --secondary: #ECF0F1;
            --accent: #3498DB;
            --text: #f0f0f0;
            --text-light: #b0b0b0;
            --bg: #121212;
            --bg-secondary: #1e1e1e;
            --card-bg: #1e1e1e;
            --border: #333333;
            --shadow: rgba(0, 0, 0, 0.3);
            --shadow-hover: rgba(0, 0, 0, 0.5);
            --footer-bg: #0a0a0a;
            --footer-text: #e0e0e0;
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Almarai', sans-serif;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        ul {
            list-style: none;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-family: inherit;
            font-size: 0.9rem;
            text-align: center;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 10px rgba(255, 107, 53, 0.3);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 107, 53, 0.4);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background-color: var(--bg-secondary);
            transform: translateY(-2px);
        }

        .section {
            padding: 5rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            font-size: 2.2rem;
            position: relative;
            padding-bottom: 1rem;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 50%;
            transform: translateX(50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 2px;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, rgba(255,107,53,0.9) 0%, rgba(44,62,80,0.9) 100%), url('hero-bg.jpg') center/cover no-repeat;
            color: white;
            padding: 8rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" preserveAspectRatio="none"><path d="M0,0 Q500,80 1000,0 L1000,100 L0,100 Z" fill="white"/></svg>');
            background-size: 100% auto;
            background-repeat: no-repeat;
            background-position: bottom;
            opacity: 0.1;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .hero-subtitle {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Features Section */
        .features {
            background-color: var(--bg-secondary);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2rem;
        }

        .feature-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 5px 15px var(--shadow);
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px var(--shadow-hover);
            border-color: var(--primary);
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            color: white;
            font-size: 2rem;
        }

        .feature-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }

        /* Header Styles */
        header {
            background-color: var(--bg);
            box-shadow: 0 2px 10px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: var(--transition);
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-family: 'Almarai', sans-serif;
            font-weight: 800;
            font-size: 1.8rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            right: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary);
            transition: var(--transition);
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-container {
            position: relative;
        }

        .search-input {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            border: 1px solid var(--border);
            background-color: var(--bg);
            color: var(--text);
            width: 200px;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            width: 250px;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .cart-icon, .theme-toggle, .instagram-icon {
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-icon:hover, .theme-toggle:hover, .instagram-icon:hover {
            color: var(--primary);
            background-color: var(--bg-secondary);
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 4px;
            width: 25px;
            height: 18px;
            position: relative;
        }

        .hamburger span {
            width: 100%;
            height: 3px;
            background-color: var(--text);
            transition: var(--transition);
            border-radius: 3px;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }

        /* Products Section */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2rem;
        }

        .product-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            border: 1px solid transparent;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px var(--shadow-hover);
            border-color: var(--primary);
        }

        .product-img-container {
            position: relative;
            overflow: hidden;
            height: 280px;
        }

        .product-img {
            height: 100%;
            width: 100%;
            object-fit: contain;
            transition: var(--transition-slow);
        }

        .product-card:hover .product-img {
            transform: scale(1.05);
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .product-specs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--text-light);
            flex-wrap: wrap;
        }

        .product-spec {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .product-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .product-rating {
            color: #FFC107;
            margin-bottom: 1rem;
        }

        .add-to-cart-btn {
            width: 100%;
            text-align: center;
        }

        /* Accessories Section */
        .accessories-section {
            background-color: var(--bg-secondary);
            border-radius: 20px;
            margin: 2rem 0;
        }

        .accessories-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2rem;
        }

        .accessory-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .accessory-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px var(--shadow-hover);
            border-color: var(--primary);
        }

        .accessory-img-container {
            position: relative;
            overflow: hidden;
            height: 240px;
        }

        .accessory-img {
            height: 100%;
            width: 100%;
            object-fit: contain;
            transition: var(--transition-slow);
        }

        .accessory-card:hover .accessory-img {
            transform: scale(1.05);
        }

        .accessory-info {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .accessory-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .accessory-description {
            color: var(--text-light);
            margin-bottom: 1rem;
            flex-grow: 1;
        }

        .accessory-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Special Offers */
        .special-offers {
            position: relative;
            overflow: hidden;
        }

        .offers-slider {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 2rem;
            padding: 1rem 0;
            scrollbar-width: none;
        }

        .offers-slider::-webkit-scrollbar {
            display: none;
        }

        .offer-card {
            flex: 0 0 300px;
            scroll-snap-align: start;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 15px;
            padding: 2rem;
            color: white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .offer-badge {
            background-color: white;
            color: var(--primary);
            padding: 0.3rem 1rem;
            border-radius: 50px;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .offer-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .offer-description {
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        /* Footer Styles */
        footer {
            background-color: var(--footer-bg);
            color: var(--footer-text);
            padding: 3rem 0 1.5rem;
        }

        .footer-container {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2rem;
        }

        .footer-logo {
            font-family: 'Almarai', sans-serif;
            font-weight: 800;
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-about p {
            margin-bottom: 1.5rem;
            color: var(--footer-text);
        }

        .footer-contact h3, .footer-links h3, .footer-newsletter h3 {
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }

        .contact-info {
            margin-bottom: 1.5rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .footer-links ul {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .footer-links a {
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .newsletter-form {
            display: flex;
            margin-top: 1rem;
        }

        .newsletter-input {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 5px 0 0 5px;
            background-color: rgba(255,255,255,0.1);
            color: var(--footer-text);
        }

        .newsletter-input:focus {
            outline: none;
            background-color: rgba(255,255,255,0.15);
        }

        .newsletter-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 0 5px 5px 0;
            padding: 0 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .newsletter-btn:hover {
            background-color: var(--primary-dark);
        }

        .social-icons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .social-icon:hover {
            background-color: var(--primary);
            transform: translateY(-3px);
        }

        .footer-bottom {
            text-align: center;
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
            color: var(--footer-text);
        }

        /* Cart Styles */
        .cart-modal {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%;
            max-width: 400px;
            height: 100%;
            background-color: var(--bg);
            box-shadow: -5px 0 15px var(--shadow);
            z-index: 1100;
            transition: var(--transition);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .cart-modal.open {
            right: 0;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .cart-title {
            font-size: 1.3rem;
            margin: 0;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-cart:hover {
            background-color: var(--bg-secondary);
        }

        .cart-items {
            padding: 1rem;
            flex: 1;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            gap: 1rem;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border);
        }

        .cart-item-img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 10px;
            background-color: var(--bg-secondary);
            padding: 0.5rem;
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-title {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .cart-item-price {
            color: var(--primary);
            font-weight: 600;
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--bg-secondary);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .quantity-btn:hover {
            background-color: var(--border);
        }

        .cart-item-quantity {
            margin: 0 0.5rem;
            min-width: 20px;
            text-align: center;
        }

        .remove-item {
            color: #ff4d4d;
            background: none;
            border: none;
            cursor: pointer;
            margin-right: auto;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .remove-item:hover {
            background-color: rgba(255, 77, 77, 0.1);
        }

        .cart-summary {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }

        .cart-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .overlay {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1050;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Product Badges */
        .product-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.3rem 0.8rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 1;
        }

        .badge-new {
            background-color: var(--success);
            color: white;
        }

        .badge-sale {
            background-color: #f44336;
            color: white;
        }

        .badge-popular {
            background-color: var(--warning);
            color: white;
        }

        /* Unified Product Modal Styles */
        .product-modal {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 1rem;
        }

        .product-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .product-modal-content {
            background-color: var(--bg);
            border-radius: 15px;
            width: 100%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: modalAppear 0.3s ease-out;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .product-modal-close {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: var(--transition);
        }

        .product-modal-close:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
        }

        .product-modal-body {
            display: flex;
            flex-direction: column;
            padding: 2rem;
        }

        .product-modal-images {
            position: relative;
            margin-bottom: 2rem;
            overflow: hidden;
            border-radius: 10px;
            background-color: var(--bg-secondary);
        }

        .product-modal-main-image {
            width: 100%;
            height: 300px;
            object-fit: contain;
            cursor: zoom-in;
            transition: var(--transition);
        }

        /* Desktop cursor-follow magnifier */
        .product-modal-magnifier {
            position: absolute;
            width: 150px;
            height: 150px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            background-repeat: no-repeat;
            pointer-events: none;
            opacity: 0;
            transform: scale(0);
            transition: opacity 0.2s, transform 0.2s;
            z-index: 5;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }

        .product-modal-magnifier.active {
            opacity: 1;
            transform: scale(1);
        }

        /* Mobile pinch/tap zoom container */
        .product-modal-mobile-zoom {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: none;
            background-repeat: no-repeat;
            z-index: 5;
            touch-action: none;
        }

        .product-modal-mobile-zoom.active {
            display: block;
        }

        .product-modal-thumbnails {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .product-modal-thumbnail {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
            border: 2px solid transparent;
            background-color: var(--bg-secondary);
        }

        .product-modal-thumbnail:hover,
        .product-modal-thumbnail.active {
            opacity: 1;
            border-color: var(--primary);
        }

        .product-modal-info {
            flex: 1;
        }

        .product-modal-title {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .product-modal-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .product-modal-rating {
            color: #FFC107;
            margin-bottom: 1.5rem;
        }

        .product-modal-description {
            margin-bottom: 1.5rem;
            line-height: 1.7;
            color: var(--text-light);
        }

        .product-modal-specs {
            margin-bottom: 2rem;
        }

        .product-modal-specs-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .product-modal-specs-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.5rem;
        }

        .product-modal-spec {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .product-modal-spec i {
            color: var(--primary);
        }

        .product-modal-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .product-modal-quantity {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .product-modal-quantity-label {
            font-weight: 500;
        }

        .product-modal-quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-control-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: var(--bg-secondary);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .quantity-control-btn:hover {
            background-color: var(--border);
        }

        .product-modal-quantity-value {
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }

        /* Search Results */
        .search-results {
            position: absolute;
            top: 100%;
            right: 0;
            width: 100%;
            max-width: 300px;
            background-color: var(--bg);
            border-radius: 10px;
            box-shadow: 0 5px 15px var(--shadow);
            z-index: 100;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        .search-results.active {
            display: block;
            animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-result-item {
            display: flex;
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: var(--transition);
        }

        .search-result-item:hover {
            background-color: var(--bg-secondary);
        }

        .search-result-img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            margin-left: 1rem;
            border-radius: 5px;
            background-color: var(--bg-secondary);
            padding: 0.25rem;
        }

        .search-result-info {
            flex: 1;
        }

        .search-result-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .search-result-price {
            color: var(--primary);
            font-weight: 600;
        }

        .no-results {
            padding: 1rem;
            text-align: center;
            color: var(--text-light);
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive styles for product modal */
        @media (min-width: 768px) {
            .product-modal-body {
                flex-direction: row;
                gap: 2rem;
            }

            .product-modal-images {
                flex: 1;
                margin-bottom: 0;
            }

            .product-modal-main-image {
                height: 400px;
            }

            .product-modal-info {
                flex: 1;
            }
        }

        @media (min-width: 992px) {
            .product-modal-main-image {
                height: 500px;
            }
        }

        /* Responsive Styles */
        @media (min-width: 576px) {
            .products-grid, .accessories-grid, .features-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .footer-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .hamburger {
                display: none;
            }
            
            .nav-links {
                display: flex;
            }
            
            .footer-container {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .accessories-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .features-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 992px) {
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .footer-container {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .accessories-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .products-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 767px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                right: 0;
                width: 100%;
                background-color: var(--bg);
                flex-direction: column;
                padding: 1rem;
                box-shadow: 0 5px 10px var(--shadow);
                z-index: 100;
                border-top: 1px solid var(--border);
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .hamburger {
                display: flex;
            }
            
            .search-input {
                display: none;
            }
            
            .search-container.active .search-input {
                display: block;
                position: absolute;
                top: 100%;
                right: 0;
                width: 250px;
                margin-top: 0.5rem;
            }
            
            /* Adjust product image height for mobile */
            .product-img-container {
                height: 220px;
            }
            
            .accessory-img-container {
                height: 200px;
            }

            /* Product modal mobile adjustments */
            .product-modal-content {
                width: 95%;
                max-height: 95vh;
            }

            .product-modal-body {
                padding: 1.5rem;
            }

            .product-modal-title {
                font-size: 1.5rem;
            }

            .product-modal-price {
                font-size: 1.5rem;
            }
            
            .hero-title {
                font-size: 2.2rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <i class="fas fa-bolt logo-icon"></i>
                ZAROTEC
            </div>
            
            <nav class="nav-links">
                <a href="#hero">الرئيسية</a>
                <a href="#products">التروتينات</a>
                <a href="#accessories">الاكسسوارات</a>
                <a href="#features">لماذا نحن</a>
                <a href="#contact">اتصل بنا</a>
            </nav>
            
            <div class="header-actions">
                <div class="search-container" id="searchContainer">
                    <input type="text" class="search-input" id="searchInput" placeholder="ابحث عن تروتينة...">
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <a href="https://www.instagram.com/teczarrouki/" target="_blank" class="instagram-icon">
                    <i class="fab fa-instagram"></i>
                </a>
                
                <div class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </div>
                
                <div class="cart-icon" id="cartIcon">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </div>
                
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">استمتع بتجربة تنقل فريدة مع تروتينات Zarotec</h1>
                <p class="hero-subtitle">اكتشف أحدث موديلات التروتينات الكهربائية بجودة عالية وأسعار منافسة</p>
                <div class="hero-buttons">
                    <a href="#products" class="btn btn-primary">استعرض المنتجات</a>
                    <a href="#features" class="btn btn-secondary">لماذا Zarotec</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="section features" id="features">
        <div class="container">
            <h2 class="section-title">لماذا تختار Zarotec</h2>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <h3 class="feature-title">توصيل سريع</h3>
                    <p>نوفر خدمة توصيل سريعة وآمنة لجميع أنحاء المغرب خلال 2-3 أيام عمل</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="feature-title">ضمان لمدة عام</h3>
                    <p>جميع منتجاتنا تأتي بضمان لمدة عام كامل على القطع والصيانة</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-headset"></i>
                    </div>
                    <h3 class="feature-title">دعم فني متواصل</h3>
                    <p>فريق دعم فني متاح على مدار الساعة لمساعدتك في أي استفسار</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="section" id="products">
        <div class="container">
            <h2 class="section-title">تروتيناتنا المميزة</h2>
            
            <div class="products-grid" id="productsGrid">
                <!-- Products will be dynamically added here -->
            </div>
        </div>
    </section>

    <!-- Special Offers -->
    <section class="section special-offers">
        <div class="container">
            <h2 class="section-title">عروض خاصة</h2>
            
            <div class="offers-slider">
                <div class="offer-card">
                    <span class="offer-badge">عرض محدود</span>
                    <h3 class="offer-title">خصم 20% على الإكسسوارات</h3>
                    <p class="offer-description">احصل على خصم 20% على جميع إكسسوارات التروتينات عند شراء أي تروتينة</p>
                    <a href="#accessories" class="btn btn-secondary">استفد من العرض</a>
                </div>
                
                <div class="offer-card">
                    <span class="offer-badge">عرض حصري</span>
                    <h3 class="offer-title">توصيل مجاني</h3>
                    <p class="offer-description">توصيل مجاني لجميع الطلبات فوق 2000 درهم لجميع أنحاء المغرب</p>
                    <a href="#products" class="btn btn-secondary">تسوق الآن</a>
                </div>
                
                <div class="offer-card">
                    <span class="offer-badge">عرض جديد</span>
                    <h3 class="offer-title">هدية مع كل طلب</h3>
                    <p class="offer-description">احصل على خوذة أمان مجانية مع كل طلب تروتينة فوق 3000 درهم</p>
                    <a href="#products" class="btn btn-secondary">اطلب الآن</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Accessories Section -->
    <section class="section accessories-section" id="accessories">
        <div class="container">
            <h2 class="section-title">اكسسوارات التروتينات</h2>
            
            <div class="accessories-grid" id="accessoriesGrid">
                <!-- Accessories will be dynamically added here -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-container">
                <div class="footer-about">
                    <div class="footer-logo">
                        <i class="fas fa-bolt"></i>
                        Zarotec
                    </div>
                    <p>متجر Zarotec يقدم أحدث التروتينات الكهربائية بجودة عالية وأسعار منافسة وخدمة ما بعد البيع المميزة.</p>
                    <div class="social-icons">
                        <a href="https://www.instagram.com/teczarrouki/" target="_blank" class="social-icon">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="fab fa-tiktok"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-contact">
                    <h3>اتصل بنا</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>contact@zarotec.ma</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>0639155501</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>المغرب</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h3>روابط سريعة</h3>
                    <ul>
                        <li><a href="#hero">الرئيسية</a></li>
                        <li><a href="#products">التروتينات</a></li>
                        <li><a href="#accessories">الاكسسوارات</a></li>
                        <li><a href="#features">لماذا نحن</a></li>
                        <li><a href="#">الشروط والأحكام</a></li>
                        <li><a href="#">سياسة الخصوصية</a></li>
                    </ul>
                </div>
                
                <div class="footer-newsletter">
                    <h3>النشرة البريدية</h3>
                    <p>اشترك في نشرتنا البريدية لتصلك آخر العروض والتحديثات.</p>
                    <form class="newsletter-form" id="newsletterForm">
                        <input type="email" class="newsletter-input" placeholder="بريدك الإلكتروني" required>
                        <button type="submit" class="newsletter-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>جميع الحقوق محفوظة &copy; 2023 Zarotec</p>
            </div>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div class="cart-modal" id="cartModal">
        <div class="cart-header">
            <h3 class="cart-title">عربة التسوق</h3>
            <button class="close-cart" id="closeCart">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="cart-items" id="cartItems">
            <!-- Cart items will be dynamically added here -->
        </div>
        
        <div class="cart-summary">
            <div class="cart-total">
                <span>المجموع:</span>
                <span id="cartTotal">0.00 درهم</span>
            </div>
            
            <div class="cart-buttons">
                <button class="btn btn-primary" id="whatsappOrderBtn">
                    <i class="fab fa-whatsapp" style="margin-left: 8px;"></i>
                    إتمام الطلب عبر واتساب
                </button>
                <button class="btn btn-secondary" id="continueShopping">مواصلة التسوق</button>
            </div>
        </div>
    </div>
    
    <div class="overlay" id="overlay"></div>

    <!-- Unified Product Modal -->
    <div class="product-modal" id="productModal" aria-hidden="true" role="dialog" aria-labelledby="productModalTitle" aria-modal="true">
        <div class="product-modal-content">
            <button class="product-modal-close" id="productModalClose" aria-label="Close product modal">
                <i class="fas fa-times"></i>
            </button>
            <div class="product-modal-body" id="productModalBody">
                <!-- Product/Accessory details will be dynamically added here -->
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const cartIcon = document.getElementById('cartIcon');
        const cartModal = document.getElementById('cartModal');
        const closeCart = document.getElementById('closeCart');
        const overlay = document.getElementById('overlay');
        const hamburger = document.getElementById('hamburger');
        const navLinks = document.querySelector('.nav-links');
        const productsGrid = document.getElementById('productsGrid');
        const accessoriesGrid = document.getElementById('accessoriesGrid');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        const cartCount = document.querySelector('.cart-count');
        const whatsappOrderBtn = document.getElementById('whatsappOrderBtn');
        const continueShoppingBtn = document.getElementById('continueShopping');
        const productModal = document.getElementById('productModal');
        const productModalClose = document.getElementById('productModalClose');
        const productModalBody = document.getElementById('productModalBody');
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const searchContainer = document.getElementById('searchContainer');
        const newsletterForm = document.getElementById('newsletterForm');

        // Cart state
        let cart = [];

        // Product modal state
        let currentProduct = null;
        let currentQuantity = 1;
        let focusableElements = [];
        let currentFocusIndex = 0;

        // Sample E-Scooter product data
        const products = [
            {
                id: 1,
                name: "Dualtron New Storm LTD",
                price: 39900,
                image: "Dualtron New Storm LTD1.jpeg",
                highResImage: "Dualtron New Storm LTD1.jpeg",
                rating: 5,
                specs: ["سرعة 100 كم/ساعة", "مدى 200 كم", "قوة 5750 واط", "بطارية 84V 45Ah"],
                category: "high-speed",
                badge: "badge-popular",
                description: "تروتينة Dualtron New Storm LTD هي نموذج فائق السرعة من إنتاج شركة Minimotors الكورية. تتميز هذه التروتينة بمحركين بقوة 5750 واط لكل منهما، مما يمكنها من الوصول إلى سرعة قصوى تبلغ 100 كم/ساعة. تحتوي على بطارية ليثيوم أيون عالية السعة 84V 45Ah توفر مدى يصل إلى 200 كم في ظروف الاستخدام العادي. تأتي مع نظام تعليق هوائي متطور، ونظام فرامل قرصية هيدروليكية، وإطارات مقاومة للثقب."
            },
            {
                id: 2,
                name: "OKAI ES10",
                price: 2690.00,
                image: "okaies10.webp",
                highResImage: "okaies10.webp",
                rating: 4,
                specs: ["سرعة 25 كم/ساعة", "مدى 20 كم", "قوة 500 واط", "تصميم خفيف"],
                category: "foldable",
                badge: "badge-new",
                description: "تروتينة OKAI ES10 هي تروتينة قابلة للطي تتميز بتصميمها الخفيف والأنيق. مثالية للتنقل في المدينة، تصل سرعتها القصوى إلى 25 كم/ساعة وتوفر مدى يصل إلى 20 كم. مزودة بمحرك بقوة 500 واط، ونظام فرامل مزدوج، وإطارات صلبة مقاومة للثقب. سهلة الطي والنقل، مما يجعلها خياراً مثالياً للاستخدام اليومي."
            },
            {
                id: 3,
                name: "Speedway Mini 4 Lite",
                price: 3990,
                image: "Speedway Mini 4 Lite.jpeg",
                highResImage: "Speedway Mini 4 Lite.jpeg",
                rating: 4,
                specs: ["سرعة 45 كم/ساعة", "مدى 35 كم", "قوة 1000 واط", "قابلة للطي"],
                category: "foldable",
                badge: "badge-sale",
                description: "Speedway Mini 4 Lite هي تروتينة قابلة للطي تجمع بين الأداء المتميز والتصميم المدمج. تصل سرعتها إلى 45 كم/ساعة وتوفر مدى يصل إلى 35 كم. مزودة بمحرك بقوة 1000 واط، ونظام فرامل قرصية، وإطارات هوائية. تتميز بخفة وزنها وسهولة طيها، مما يجعلها مناسبة للاستخدام في المدينة والتنقل."
            },
            {
                id: 4,
                name: "M41 Ultimate",
                price: 6500,
                image: "M41 Ultimate.webp",
                highResImage: "M41 Ultimate.webp",
                rating: 5,
                specs: ["سرعة 60 كم/ساعة", "مدى 50 كم", "قوة 1200 واط"],
                category: "off-road",
                badge: "badge-popular",
                description: "M41 Ultimate هي تروتينة مصممة خصيصاً للطرق الوعرة والتضاريس الصعبة. تصل سرعتها إلى 60 كم/ساعة وتوفر مدى يصل إلى 50 كم. مزودة بمحرك بقوة 1200 واط، ونظام تعليق أمامي وخلفي، وإطارات كبيرة وعريضة مناسبة للطرق الوعرة. تتميز بمتانتها وقدرتها على تحمل الاستخدام الشاق."
            }
        ];

        // Sample Accessories data
        const accessories = [
            {
                id: 101,
                name: "خوذة أمان",
                price: 329,
                image: "casck.jpeg",
                highResImage: "casck.jpeg",
                description: "خوذة أمان عالية الجودة لحماية الرأس أثناء ركوب التروتينات. تتميز بتصميم مريح وتهوية جيدة."
            },
            {
                id: 102,
                name: "حقيبة تخزين",
                price: 199,
                image: "cartable.jpeg",
                highResImage: "cartable.jpeg",
                description: "حقيبة صدر ذكية مزودة بإضاءة LED، عملية وخفيفة للتنقّل اليومي"
            },
            {
                id: 103,
                name: "مصباح LED للتروتينت ببطارية USB",
                price: 129,
                image: "kachaf.jpeg",
                highResImage: "kachaf.jpeg",
                description: "مصباح أمامي قويّ للتروتينت، قابل للشحن عبر USB، مقاوم للماء وسهل التثبيت على المقود"
            },
            {
                id: 104,
                name: "قفل أمان للتروتينت",
                price: 89,
                image: "9fl.jpeg",
                highResImage: "9fl.jpeg",
                description: "قفل أمان قوي ومقاوم للقطع لحماية تروتينتك من السرقة."
            },
            {
                id: 105,
                name: "حقيبة للتروتينت",
                price: 159,
                image: "chkara.jpeg",
                highResImage: "chkara.jpeg",
                description: "حقيبة متينة لحمل أغراضك الشخصية أثناء ركوب التروتينت."
            },
            {
                id: 106,
                name: "حاملة هاتف للتروتينة",
                price: 79,
                image: "360.jpeg",
                highResImage: "360.jpeg",
                description: "حاملة هاتف معدنية قوية قابلة للدوران 360°"
            }
        ];

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize functionality
            initializeTheme();
            renderProducts();
            renderAccessories();
            updateCart();
            initializeSearch();
            initializeProductModal();
            
            // Event listeners
            themeToggle.addEventListener('click', toggleTheme);
            cartIcon.addEventListener('click', openCart);
            closeCart.addEventListener('click', closeCartModal);
            overlay.addEventListener('click', function() {
                closeCartModal();
                closeProductModal();
                closeMobileMenu();
            });
            hamburger.addEventListener('click', toggleMobileMenu);
            whatsappOrderBtn.addEventListener('click', sendWhatsAppOrder);
            continueShoppingBtn.addEventListener('click', closeCartModal);
            productModalClose.addEventListener('click', closeProductModal);
            newsletterForm.addEventListener('submit', handleNewsletterSubmit);
            
            // Close mobile menu when clicking on a link
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', closeMobileMenu);
            });
        });

        // Search functionality
        function initializeSearch() {
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.trim().toLowerCase();
                
                if (searchTerm.length < 2) {
                    searchResults.classList.remove('active');
                    return;
                }
                
                // Search in products and accessories
                const allItems = [...products, ...accessories];
                const results = allItems.filter(item => 
                    item.name.toLowerCase().includes(searchTerm) || 
                    (item.description && item.description.toLowerCase().includes(searchTerm))
                );
                
                displaySearchResults(results);
            });
            
            // Close search results when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchContainer.contains(e.target)) {
                    searchResults.classList.remove('active');
                    searchContainer.classList.remove('active');
                }
            });
            
            // Toggle search on mobile
            if (window.innerWidth <= 767) {
                searchContainer.addEventListener('click', function(e) {
                    if (e.target === searchContainer) {
                        searchContainer.classList.toggle('active');
                        if (searchContainer.classList.contains('active')) {
                            searchInput.focus();
                        }
                    }
                });
            }
        }
        
        function displaySearchResults(results) {
            searchResults.innerHTML = '';
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="no-results">لا توجد نتائج</div>';
            } else {
                results.forEach(item => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';
                    resultItem.innerHTML = `
                        <img src="${item.image}" alt="${item.name}" class="search-result-img">
                        <div class="search-result-info">
                            <div class="search-result-title">${item.name}</div>
                            <div class="search-result-price">${item.price} درهم</div>
                        </div>
                    `;
                    
                    resultItem.addEventListener('click', function() {
                        openProductModal(item.id);
                        searchResults.classList.remove('active');
                        searchInput.value = '';
                        searchContainer.classList.remove('active');
                    });
                    
                    searchResults.appendChild(resultItem);
                });
            }
            
            searchResults.classList.add('active');
        }

        // Unified Product Modal Functionality
        function initializeProductModal() {
            // Close modal when clicking outside content
            productModal.addEventListener('click', function(e) {
                if (e.target === productModal) {
                    closeProductModal();
                }
            });

            // Close modal with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && productModal.classList.contains('active')) {
                    closeProductModal();
                }
            });
        }

        // Focus trap for accessibility
        function trapFocus(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                
                if (e.shiftKey) {
                    // Shift + Tab
                    currentFocusIndex = currentFocusIndex > 0 ? currentFocusIndex - 1 : focusableElements.length - 1;
                } else {
                    // Tab
                    currentFocusIndex = currentFocusIndex < focusableElements.length - 1 ? currentFocusIndex + 1 : 0;
                }
                
                focusableElements[currentFocusIndex].focus();
            }
        }

        function openProductModal(itemId) {
            // Find item by ID (check both products and accessories)
            let item = products.find(p => p.id === itemId);
            if (!item) {
                item = accessories.find(a => a.id === itemId);
            }
            if (!item) return;

            currentProduct = item;
            currentQuantity = 1;

            // Lazy load high-resolution image
            const highResImage = new Image();
            highResImage.src = item.highResImage || item.image;
            highResImage.onload = function() {
                renderProductModalContent(item, highResImage.src);
            };

            highResImage.onerror = function() {
                // Fallback to regular image if high-res fails to load
                console.log('High resolution image failed to load, using regular image');
                renderProductModalContent(item, item.image);
            };
        }

        function renderProductModalContent(item, imageSrc) {
            // Check if it's a product (has specs) or accessory
            const isProduct = item.specs !== undefined;
            
            productModalBody.innerHTML = `
                <div class="product-modal-images">
                    <img src="${imageSrc}" alt="${item.name}" class="product-modal-main-image" id="productModalMainImage">
                    <div class="product-modal-magnifier" id="productModalMagnifier"></div>
                    <div class="product-modal-mobile-zoom" id="productModalMobileZoom"></div>
                    <div class="product-modal-thumbnails">
                        <img src="${item.image}" alt="${item.name}" class="product-modal-thumbnail active" data-image="${imageSrc}">
                        <!-- Additional thumbnails can be added here if available -->
                    </div>
                </div>
                <div class="product-modal-info">
                    <h1 class="product-modal-title" id="productModalTitle">${item.name}</h1>
                    <div class="product-modal-price">${isProduct ? item.price.toLocaleString() : item.price} درهم</div>
                    ${isProduct ? `
                    <div class="product-modal-rating">
                        ${'<i class="fas fa-star"></i>'.repeat(item.rating)}${'<i class="far fa-star"></i>'.repeat(5 - item.rating)}
                    </div>
                    ` : ''}
                    <div class="product-modal-description">
                        <h3>الوصف</h3>
                        <p>${item.description}</p>
                    </div>
                    ${isProduct ? `
                    <div class="product-modal-specs">
                        <h3>المواصفات</h3>
                        <div class="product-modal-specs-list">
                            ${item.specs.map(spec => `
                                <div class="product-modal-spec">
                                    <i class="fas fa-check"></i>
                                    <span>${spec}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    <div class="product-modal-actions">
                        <div class="product-modal-quantity">
                            <span class="product-modal-quantity-label">الكمية:</span>
                            <div class="product-modal-quantity-controls">
                                <button class="quantity-control-btn" id="decreaseQuantity">-</button>
                                <span class="product-modal-quantity-value" id="productModalQuantity">${currentQuantity}</span>
                                <button class="quantity-control-btn" id="increaseQuantity">+</button>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="addToCartFromModal">أضف إلى السلة</button>
                    </div>
                </div>
            `;

            // Initialize image zoom functionality
            initializeImageZoom(imageSrc);

            // Initialize quantity controls
            document.getElementById('decreaseQuantity').addEventListener('click', function() {
                if (currentQuantity > 1) {
                    currentQuantity--;
                    document.getElementById('productModalQuantity').textContent = currentQuantity;
                }
            });

            document.getElementById('increaseQuantity').addEventListener('click', function() {
                currentQuantity++;
                document.getElementById('productModalQuantity').textContent = currentQuantity;
            });

            // Initialize add to cart button
            document.getElementById('addToCartFromModal').addEventListener('click', function() {
                for (let i = 0; i < currentQuantity; i++) {
                    addToCart(item.id);
                }
                closeProductModal();
                showNotification('تمت إضافة المنتج إلى السلة');
            });

            // Set up focus trap
            focusableElements = [
                productModalClose,
                document.getElementById('decreaseQuantity'),
                document.getElementById('increaseQuantity'),
                document.getElementById('addToCartFromModal')
            ];
            currentFocusIndex = 0;
            document.addEventListener('keydown', trapFocus);

            // Show modal
            productModal.setAttribute('aria-hidden', 'false');
            productModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            overlay.classList.add('active');
            
            // Focus first element
            setTimeout(() => {
                productModalClose.focus();
            }, 100);
        }

        function closeProductModal() {
            productModal.setAttribute('aria-hidden', 'true');
            productModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            overlay.classList.remove('active');
            currentProduct = null;
            currentQuantity = 1;
            
            // Remove focus trap
            document.removeEventListener('keydown', trapFocus);
        }

        function initializeImageZoom(imageSrc) {
            const mainImage = document.getElementById('productModalMainImage');
            const magnifier = document.getElementById('productModalMagnifier');
            const mobileZoom = document.getElementById('productModalMobileZoom');
            
            // Check if device is mobile
            const isMobile = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            
            if (isMobile) {
                // Mobile pinch/tap zoom functionality
                let scale = 1;
                let lastScale = 1;
                let isDragging = false;
                let startX, startY, translateX = 0, translateY = 0;
                let initialDistance = 0;
                
                mainImage.addEventListener('touchstart', function(e) {
                    if (e.touches.length === 1) {
                        // Single touch - prepare for drag
                        isDragging = true;
                        startX = e.touches[0].clientX - translateX;
                        startY = e.touches[0].clientY - translateY;
                    } else if (e.touches.length === 2) {
                        // Two touches - prepare for pinch
                        const touch1 = e.touches[0];
                        const touch2 = e.touches[1];
                        initialDistance = Math.sqrt(
                            Math.pow(touch2.clientX - touch1.clientX, 2) +
                            Math.pow(touch2.clientY - touch1.clientY, 2)
                        );
                        lastScale = scale;
                    }
                });
                
                mainImage.addEventListener('touchmove', function(e) {
                    if (e.touches.length === 1 && isDragging) {
                        // Single touch drag
                        translateX = e.touches[0].clientX - startX;
                        translateY = e.touches[0].clientY - startY;
                        
                        // Apply transform
                        mobileZoom.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
                    } else if (e.touches.length === 2) {
                        // Pinch zoom
                        const touch1 = e.touches[0];
                        const touch2 = e.touches[1];
                        
                        const distance = Math.sqrt(
                            Math.pow(touch2.clientX - touch1.clientX, 2) +
                            Math.pow(touch2.clientY - touch1.clientY, 2)
                        );
                        
                        // Calculate scale based on initial distance
                        scale = Math.min(Math.max(1, lastScale * (distance / initialDistance)), 3);
                        
                        // Apply transform
                        mobileZoom.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
                    }
                });
                
                mainImage.addEventListener('touchend', function(e) {
                    isDragging = false;
                });
                
                // Double tap to toggle zoom
                let lastTap = 0;
                mainImage.addEventListener('touchend', function(e) {
                    const currentTime = new Date().getTime();
                    const tapLength = currentTime - lastTap;
                    
                    if (tapLength < 300 && tapLength > 0) {
                        // Double tap detected
                        if (scale === 1) {
                            scale = 2;
                            translateX = 0;
                            translateY = 0;
                        } else {
                            scale = 1;
                            translateX = 0;
                            translateY = 0;
                        }
                        
                        mobileZoom.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
                    }
                    
                    lastTap = currentTime;
                });
                
                // Set up mobile zoom container
                mobileZoom.style.backgroundImage = `url('${imageSrc}')`;
                mobileZoom.style.backgroundSize = '100% 100%';
                
                mainImage.addEventListener('click', function() {
                    mobileZoom.classList.toggle('active');
                });
                
            } else {
                // Desktop cursor-follow magnifier functionality
                mainImage.addEventListener('mousemove', function(e) {
                    const { left, top, width, height } = mainImage.getBoundingClientRect();
                    const x = ((e.pageX - left) / width) * 100;
                    const y = ((e.pageY - top) / height) * 100;
                    
                    magnifier.style.backgroundImage = `url('${imageSrc}')`;
                    magnifier.style.backgroundPosition = `${x}% ${y}%`;
                    magnifier.style.backgroundSize = `${width * 2}px ${height * 2}px`;
                    magnifier.style.left = `${e.pageX - 75}px`;
                    magnifier.style.top = `${e.pageY - 75}px`;
                    magnifier.classList.add('active');
                });
                
                mainImage.addEventListener('mouseleave', function() {
                    magnifier.classList.remove('active');
                });
            }
            
            // Thumbnail click functionality
            const thumbnails = document.querySelectorAll('.product-modal-thumbnail');
            thumbnails.forEach(thumbnail => {
                thumbnail.addEventListener('click', function() {
                    // Remove active class from all thumbnails
                    thumbnails.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked thumbnail
                    this.classList.add('active');
                    
                    // Update main image
                    const newImageSrc = this.getAttribute('data-image');
                    
                    mainImage.src = newImageSrc;
                    
                    // Update zoom containers
                    if (!isMobile) {
                        magnifier.style.backgroundImage = `url('${newImageSrc}')`;
                    } else {
                        mobileZoom.style.backgroundImage = `url('${newImageSrc}')`;
                    }
                });
            });
        }

        // Theme functionality
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                document.body.classList.remove('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }

        function toggleTheme() {
            if (document.body.classList.contains('dark-mode')) {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            } else {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
        }

        // Render products
        function renderProducts() {
            productsGrid.innerHTML = '';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.setAttribute('data-category', product.category);
                productCard.setAttribute('data-id', product.id);
                
                // Add badge if exists
                const badgeHTML = product.badge ? `<div class="product-badge ${product.badge}">${product.badge === 'badge-new' ? 'جديد' : product.badge === 'badge-sale' ? 'عرض' : 'الأكثر مبيعاً'}</div>` : '';
                
                productCard.innerHTML = `
                    ${badgeHTML}
                    <div class="product-img-container">
                        <img src="${product.image}" alt="${product.name}" class="product-img">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">${product.name}</h3>
                        <div class="product-specs">
                            ${product.specs.map(spec => `
                                <div class="product-spec">
                                    <i class="fas fa-check"></i>
                                    <span>${spec}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="product-price">${product.price.toLocaleString()} درهم</div>
                        <div class="product-rating">
                            ${'<i class="fas fa-star"></i>'.repeat(product.rating)}${'<i class="far fa-star"></i>'.repeat(5 - product.rating)}
                        </div>
                        <button class="btn btn-primary add-to-cart-btn" data-id="${product.id}">اضف الى السلة</button>
                    </div>
                `;
                
                productsGrid.appendChild(productCard);
            });
            
            // Add event listeners to "Add to Cart" buttons
            document.querySelectorAll('.product-card .add-to-cart-btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation(); // Prevent triggering the product card click
                    const productId = parseInt(this.getAttribute('data-id'));
                    addToCart(productId);
                });
            });
            
            // Add click event to product cards to open modal
            document.querySelectorAll('.product-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // Don't open modal if clicking the "Add to Cart" button
                    if (e.target.classList.contains('add-to-cart-btn')) {
                        return;
                    }
                    
                    const productId = parseInt(this.getAttribute('data-id'));
                    openProductModal(productId);
                });
            });
        }

        // Render accessories
        function renderAccessories() {
            accessoriesGrid.innerHTML = '';
            
            accessories.forEach(accessory => {
                const accessoryCard = document.createElement('div');
                accessoryCard.className = 'accessory-card';
                accessoryCard.setAttribute('data-id', accessory.id);
                accessoryCard.innerHTML = `
                    <div class="accessory-img-container">
                        <img src="${accessory.image}" alt="${accessory.name}" class="accessory-img">
                    </div>
                    <div class="accessory-info">
                        <h3 class="accessory-title">${accessory.name}</h3>
                        <p class="accessory-description">${accessory.description}</p>
                        <div class="accessory-price">${accessory.price} درهم</div>
                        <button class="btn btn-primary add-to-cart-btn" data-id="${accessory.id}">اضف الى السلة</button>
                    </div>
                `;
                
                accessoriesGrid.appendChild(accessoryCard);
            });
            
            // Add event listeners to accessory "Add to Cart" buttons
            document.querySelectorAll('.accessory-card .add-to-cart-btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation(); // Prevent triggering the card click
                    const accessoryId = parseInt(this.getAttribute('data-id'));
                    addToCart(accessoryId);
                });
            });
            
            // Add click event to accessory cards to open modal
            document.querySelectorAll('.accessory-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // Don't open modal if clicking the "Add to Cart" button
                    if (e.target.classList.contains('add-to-cart-btn')) {
                        return;
                    }
                    
                    const accessoryId = parseInt(this.getAttribute('data-id'));
                    openProductModal(accessoryId);
                });
            });
        }

        // Cart functionality
        function addToCart(itemId) {
            // Check if it's a product or accessory
            let item;
            if (itemId < 100) {
                item = products.find(p => p.id === itemId);
            } else {
                item = accessories.find(a => a.id === itemId);
            }
            
            if (!item) return;
            
            const existingItem = cart.find(cartItem => cartItem.id === itemId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    image: item.image,
                    quantity: 1
                });
            }
            
            updateCart();
            showNotification('تمت إضافة المنتج إلى السلة');
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCart();
        }

        function updateCartQuantity(itemId, newQuantity) {
            const item = cart.find(item => item.id === itemId);
            if (item) {
                if (newQuantity <= 0) {
                    removeFromCart(itemId);
                } else {
                    item.quantity = newQuantity;
                }
                updateCart();
            }
        }

        function updateCart() {
            // Update cart items
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p style="text-align: center; padding: 2rem;">السلة فارغة</p>';
            } else {
                cart.forEach(item => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <img src="${item.image}" alt="${item.name}" class="cart-item-img">
                        <div class="cart-item-details">
                            <h4 class="cart-item-title">${item.name}</h4>
                            <div class="cart-item-price">${item.price} درهم</div>
                            <div class="cart-item-actions">
                                <button class="quantity-btn decrease" data-id="${item.id}">-</button>
                                <span class="cart-item-quantity">${item.quantity}</span>
                                <button class="quantity-btn increase" data-id="${item.id}">+</button>
                                <button class="remove-item" data-id="${item.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    cartItems.appendChild(cartItem);
                });
                
                // Add event listeners to cart item buttons
                document.querySelectorAll('.decrease').forEach(button => {
                    button.addEventListener('click', function() {
                        const itemId = parseInt(this.getAttribute('data-id'));
                        const item = cart.find(item => item.id === itemId);
                        updateCartQuantity(itemId, item.quantity - 1);
                    });
                });
                
                document.querySelectorAll('.increase').forEach(button => {
                    button.addEventListener('click', function() {
                        const itemId = parseInt(this.getAttribute('data-id'));
                        const item = cart.find(item => item.id === itemId);
                        updateCartQuantity(itemId, item.quantity + 1);
                    });
                });
                
                document.querySelectorAll('.remove-item').forEach(button => {
                    button.addEventListener('click', function() {
                        const itemId = parseInt(this.getAttribute('data-id'));
                        removeFromCart(itemId);
                    });
                });
            }
            
            // Update cart total and count
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotal.textContent = `${total.toFixed(2)} درهم`;
            cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            // Update WhatsApp button
            if (cart.length > 0) {
                let message = 'مرحباً، أريد طلب المنتجات التالية من متجر Zarotec:%0A%0A';
                
                cart.forEach((item, index) => {
                    message += `${index + 1}. ${item.name}%0A`;
                    message += `   الكمية: ${item.quantity}%0A`;
                    message += `   السعر: ${item.price} درهم%0A`;
                    message += `   المجموع: ${(item.price * item.quantity).toFixed(2)} درهم%0A%0A`;
                });
                
                message += `%0Aالمجموع الكلي: ${total.toFixed(2)} درهم%0A%0A`;
                message += 'أرجو التواصل معي لتأكيد الطلب وتفاصيل الشحن.%0A%0A';
                message += 'شكراً لكم!%0Aمتجر Zarotec';
                
                const phoneNumber = '212639155501';
                whatsappOrderBtn.onclick = function() {
                    if (confirm('هل تريد متابعة الطلب عبر واتساب؟ سيتم فتح تطبيق واتساب.')) {
                        window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
                        closeCartModal();
                    }
                };
                whatsappOrderBtn.style.cursor = 'pointer';
            } else {
                whatsappOrderBtn.onclick = function() {
                    alert('السلة فارغة. أضف منتجات قبل إرسال الطلب.');
                };
                whatsappOrderBtn.style.cursor = 'not-allowed';
            }
        }

        function openCart() {
            cartModal.classList.add('open');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeCartModal() {
            cartModal.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function toggleMobileMenu() {
            navLinks.classList.toggle('active');
            hamburger.classList.toggle('active');
            
            if (navLinks.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        }

        function closeMobileMenu() {
            navLinks.classList.remove('active');
            hamburger.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function sendWhatsAppOrder(e) {
            if (cart.length === 0) {
                e.preventDefault();
                alert('السلة فارغة. أضف منتجات قبل إرسال الطلب.');
                return;
            }
            
            closeCartModal();
        }

        function handleNewsletterSubmit(e) {
            e.preventDefault();
            const emailInput = e.target.querySelector('.newsletter-input');
            const email = emailInput.value.trim();
            
            if (!email) {
                showNotification('يرجى إدخال بريد إلكتروني صحيح');
                return;
            }
            
            // Simulate form submission
            const submitBtn = e.target.querySelector('.newsletter-btn');
            const originalHtml = submitBtn.innerHTML;
            submitBtn.innerHTML = '<div class="loading-spinner"></div>';
            
            setTimeout(() => {
                submitBtn.innerHTML = originalHtml;
                showNotification('شكراً لك! تم الاشتراك في النشرة البريدية بنجاح');
                emailInput.value = '';
            }, 1500);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background-color: var(--primary);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 2000;
                transition: all 0.3s ease;
                transform: translateX(100%);
                max-width: 300px;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>